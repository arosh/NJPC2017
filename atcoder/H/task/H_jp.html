<span class="lang">
<span class="lang-ja">
<p>配点 : <var>1000</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p><var>N</var> 頂点の根付き木が与えられます。各頂点には <var>1, 2, …, N</var> と番号がつけられており，頂点 <var>1</var> はこの根付き木の根です。辺はすべて無向辺で，<var>i</var> 番目 ( <var>2 ≦ i ≦ N</var> ) の頂点の親は <var>p_i</var> です。</p>
<p>最初，各頂点は白または黒に塗られており，<var>i</var> 番目の頂点 ( <var>1 ≦ i ≦ N</var> ) の初期の色は <var>C_i = 0</var> のとき白色，<var>C_i = 1</var> のとき黒色です。</p>
<p><var>Q</var> 個のクエリが与えられるので，順番に処理してください。クエリは以下の2種類のどちらかで，入力形式とクエリの内容は以下のとおりです。</p>
<ul>
<li><code>1 u</code>：頂点 <var>u</var> を根とする部分木に含まれるすべての頂点の色を反転させる。</li>
<li><code>2 u v</code>：頂点 <var>u</var> から <var>v</var> へ，白い頂点と黒い頂点を交互に通って辿り着くことができるならば<code>YES</code>，そうでなければ<code>NO</code>を出力せよ。最初の色は白でも黒でもかまわない。</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>入力は全て整数である。</li>
<li><var>2≦N≦10^5</var></li>
<li><var>1≦p_i≦N</var></li>
<li><var>C_i = 0</var> または <var>1</var></li>
<li><var>1≦Q≦10^5</var></li>
<li>入力される根付き木は必ず連結である。</li>
<li>クエリが<code>1 u</code>のとき、<var>1≦u≦N</var> である。</li>
<li>クエリが<code>2 u v</code>のとき、<var>1≦u,v≦N</var> かつ <var>u≠v</var> である。</li>
<li><code>2 u v</code>というフォーマットのクエリが少なくとも1つ存在することが保証される。</li>
</ul>
</section>
</div>

<hr />

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>p_2</var>
<var>p_3</var>
<var>:</var>
<var>p_N</var>
<var>C_1</var>
<var>C_2</var>
<var>:</var>
<var>C_N</var>
<var>Q</var>
<var>query_1</var>
<var>query_2</var>
<var>:</var>
<var>query_Q</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p><code>2 u v</code>というフォーマットのクエリに対する答えを，クエリが与えられた順にそれぞれ 1 行ずつ出力せよ。</p>
</section>
</div>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 1</h3><pre>6
1
1
2
2
3
0
1
0
0
1
1
10
2 4 1
2 4 3
2 1 2
1 2
2 4 1
1 3
1 5
2 1 6
1 1
2 5 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>YES
NO
YES
NO
YES
YES
</pre>

</section>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 2</h3><pre>7
1
2
3
3
5
6
0
0
1
0
0
1
1
7
2 1 4
2 4 2
2 4 5
2 4 6
2 6 1
2 7 1
2 2 6
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>NO
YES
YES
YES
NO
NO
YES
</pre>

</section>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 3</h3><pre>2
1
0
1
11
2 1 2
2 2 1
1 2
2 1 2
2 2 1
1 1
2 1 2
2 2 1
1 2
2 1 2
2 2 1
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>YES
YES
NO
NO
NO
NO
YES
YES
</pre>

</section>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 4</h3><pre>5
1
2
3
4
0
1
0
1
0
11
2 1 2
2 1 4
2 3 1
2 5 1
2 4 5
1 3
2 1 2
2 1 4
2 3 1
2 5 1
2 4 5
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>YES
YES
YES
YES
YES
YES
NO
NO
NO
YES
</pre>

</section>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 5</h3><pre>9
4
2
6
8
1
4
1
8
0
0
1
0
0
1
1
1
0
2
2 9 8
2 9 4
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 5</h3><pre>YES
YES
</pre></section>
</div>
</span>
</span>
